<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Paul Northrop" />

<meta name="date" content="2023-12-02" />

<title>An overview of lax</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">An overview of lax</h1>
<h4 class="author">Paul Northrop</h4>
<h4 class="date">2023-12-02</h4>


<div id="TOC">
<ul>
<li><a href="#gev-regression-of-annual-maximum-temperatures" id="toc-gev-regression-of-annual-maximum-temperatures">GEV regression of
annual maximum temperatures</a></li>
<li><a href="#ismev" id="toc-ismev">ismev</a>
<ul>
<li><a href="#confidence-intervals" id="toc-confidence-intervals">Confidence intervals</a></li>
<li><a href="#confidence-regions" id="toc-confidence-regions">Confidence
regions</a></li>
<li><a href="#comparing-nested-models" id="toc-comparing-nested-models">Comparing nested models</a></li>
</ul></li>
<li><a href="#texmex" id="toc-texmex">texmex</a></li>
<li><a href="#evd" id="toc-evd">evd</a></li>
<li><a href="#extremes" id="toc-extremes">extRemes</a></li>
<li><a href="#eva" id="toc-eva">eva</a></li>
<li><a href="#evir" id="toc-evir">evir</a></li>
<li><a href="#fextremes" id="toc-fextremes">fExtremes</a></li>
<li><a href="#mev" id="toc-mev">mev</a></li>
<li><a href="#pot" id="toc-pot">POT</a></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul>
</div>

<p>The <a href="https://CRAN.R-project.org/view=ExtremeValue">CRAN Task
View on Extreme Value Analysis</a> provides information about R packages
that perform various extreme value analyses. The <em>lax</em> package
supplements the functionality of nine of these packages, namely <a href="https://cran.r-project.org/package=evd">eva</a> <span class="citation">(Bader and Yan 2020)</span>, <a href="https://cran.r-project.org/package=evd">evd</a> <span class="citation">(Stephenson 2002)</span>, <a href="https://cran.r-project.org/package=evir">evir</a> <span class="citation">(Pfaff and McNeil 2018)</span>, <a href="https://cran.r-project.org/package=extRemes">extRemes</a> <span class="citation">(Gilleland and Katz 2016)</span>, <a href="https://cran.r-project.org/package=fExtremes">fExtremes</a> <span class="citation">(Wuertz, Setz, and Yohan Chalabi 2017)</span>, <a href="https://cran.r-project.org/package=ismev">ismev</a> <span class="citation">(Heffernan and Stephenson 2018)</span>, <a href="https://cran.r-project.org/package=mev">mev</a> <span class="citation">(Belzile et al. 2019)</span>, <a href="https://cran.r-project.org/package=POT">POT</a> <span class="citation">(Ribatet and Dutang 2016)</span> and <a href="https://cran.r-project.org/package=texmex">texmex</a> <span class="citation">(Southworth, Heffernan, and Metcalfe 2017)</span>.
Univariate extreme value models, including regression models, are
supported.</p>
<p>The <a href="https://cran.r-project.org/package=chandwich">chandwich</a>
package is used to provide robust sandwich estimation of parameter
covariance matrix and loglikelihood adjustment for models fitted by
maximum likelihood estimation. This may be useful for cluster correlated
data when interest lies in the parameters of the marginal distributions,
or for performing inferences that are robust to certain types of model
misspecification.</p>
<p><em>lax</em> works in an object-oriented way, operating on R objects
returned from functions in other packages that summarise the fit of an
extreme value model. Loglikelihood adjustment and sandwich estimation is
performed by an <code>alogLik</code> S3 method. We demonstrate this
using the following running example, which involves fitting a
Generalised Extreme Value (GEV) regression model. Firstly, we use the
<em>ismev</em> package to produce the fitted GEV regression model object
on which <code>alogLik</code> will operate, and illustrate what can be
done with the objects returned from <code>alogLik</code>. We use the
<em>ismev</em> package because it provides an example of a case where we
need to refit the model in order to obtain the information that we need
to perform adjusted inferences. Then we repeat the adjustment using
seven of the other eight packages. The <em>POT</em> package specialises
in Generalised Pareto (GP) modelling, for which we use a different
example.</p>
<div id="gev-regression-of-annual-maximum-temperatures" class="section level2">
<h2>GEV regression of annual maximum temperatures</h2>
<p>This example is based on the analysis presented in Section 5.2 of
<span class="citation">Chandler and Bate (2007)</span>. The data, which
are available in the data frame <code>ow</code>, are a bivariate time
series of annual maximum temperatures, recorded in degrees Fahrenheit,
at Oxford and Worthing in England, for the period 1901 to 1980. If
interest is only in the marginal distributions of high temperatures in
Oxford and Worthing, then we might fit a GEV regression model in which
some or all of the parameters may vary between Oxford and Worthing.
However, we should adjust for the cluster dependence between
temperatures recorded during the same year.</p>
</div>
<div id="ismev" class="section level2">
<h2>ismev</h2>
<p>The <code>gev.fit()</code> function in <em>ismev</em> fits GEV
regression models. It allows covariate effects in any of the (location,
scale and shape) parameters of the GEV distribution. However, an object
returned from <code>gev.fit()</code> does not provide all the
information about a fitted regression model that <code>alogLik</code>
needs, in order to calculate loglikelihood contributions from individual
observations: the design matrices are missing. Therefore, <em>lax</em>
provides the function <code>gev_refit</code>, which is a version of
<code>gev.fit</code> that adds this information.</p>
<p>The following code fits a GEV regression model in which the location,
scale and shape parameters of the GEV distribution vary between Oxford
and Worthing. Then <code>alogLik</code> is used to provide adjusted
standard errors and an adjusted loglikelihood.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(lax)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co"># Column 4 of ow contains 1 for Oxford and -1 for Worthing</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>large <span class="ot">&lt;-</span> <span class="fu">gev_refit</span>(ow<span class="sc">$</span>temp, ow, <span class="at">mul =</span> <span class="dv">4</span>, <span class="at">sigl =</span> <span class="dv">4</span>, <span class="at">shl =</span> <span class="dv">4</span>, <span class="at">show =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;BFGS&quot;</span>)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co"># Adjust the loglikelihood and standard errors</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>adj_large <span class="ot">&lt;-</span> <span class="fu">alogLik</span>(large, <span class="at">cluster =</span> ow<span class="sc">$</span>year, <span class="at">cadjust =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co"># MLEs, SEs and adjusted SEs</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="fu">t</span>(<span class="fu">summary</span>(adj_large))</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co">#&gt;             loc locloc  scale scaleloc    shape shapeloc</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co">#&gt; MLE     81.1700 2.6690 3.7290   0.5312 -0.19890 -0.08835</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="co">#&gt; SE       0.3282 0.3282 0.2292   0.2292  0.04937  0.04937</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="co">#&gt; adj. SE  0.4036 0.2128 0.2425   0.1911  0.03944  0.03625</span></span></code></pre></div>
<p>This reproduces the values in rows 1, 3 and 4 in Table 2 of <span class="citation">Chandler and Bate (2007)</span>. The estimation of the
‘meat’ of the sandwich adjustment is performed using the <a href="https://cran.r-project.org/package=sandwich">sandwich</a> package.
In this example, we need to pass <code>cadjust = FALSE</code> to
<code>sandwich::meatCL</code> in order that the adjustment is the same
as that used in <span class="citation">Chandler and Bate (2007)</span>.
Otherwise, <code>meatCL</code> makes a finite-cluster bias
correction.</p>
<div id="confidence-intervals" class="section level3">
<h3>Confidence intervals</h3>
<p>A <code>confint</code> method calculates approximate (95%) confidence
intervals for the parameters, based on the adjusted loglikelihood. <span class="citation">Chandler and Bate (2007)</span> consider three types of
loglikelihood adjustment: one vertical and two horizontal. The type of
adjustment is selected by the argument <code>type</code>. The default is
<code>type = &quot;vertical&quot;</code> and there is an option to perform no
adjustment.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">confint</span>(adj_large)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt;               2.5 %     97.5 %</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt; loc      80.3729001 81.9602100</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt; locloc    2.2437419  3.0831279</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt; scale     3.2991896  4.2598984</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt; scaleloc  0.1611912  0.9433844</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt; shape    -0.2741177 -0.1157069</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt; shapeloc -0.1652089 -0.0200268</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="fu">confint</span>(adj_large, <span class="at">type =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#&gt;                2.5 %       97.5 %</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#&gt; loc      80.52440863 81.813160870</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#&gt; locloc    2.01969229  3.308352990</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#&gt; scale     3.32435238  4.236272757</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#&gt; scaleloc  0.09100223  1.020139218</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&gt; shape    -0.28957175 -0.094326264</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&gt; shapeloc -0.18850187  0.008628523</span></span></code></pre></div>
</div>
<div id="confidence-regions" class="section level3">
<h3>Confidence regions</h3>
<p>The <code>conf_region</code> function in the <em>chandwich</em>
package can be used to produce confidence regions for pairs of
parameters. Here, we consider the ‘central’ (midway between Oxford and
Worthing) scale and shape intercept parameters: <span class="math inline">\(\sigma_0\)</span> and <span class="math inline">\(\xi_0\)</span> in <span class="citation">Chandler
and Bate (2007)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">library</span>(chandwich)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>which_pars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;scale&quot;</span>, <span class="st">&quot;shape&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>gev_none <span class="ot">&lt;-</span> <span class="fu">conf_region</span>(adj_large, <span class="at">which_pars =</span> which_pars, <span class="at">type =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>gev_vertical <span class="ot">&lt;-</span> <span class="fu">conf_region</span>(adj_large, <span class="at">which_pars =</span> which_pars)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="fu">plot</span>(gev_none, gev_vertical, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">3.1</span>, <span class="fl">4.5</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.35</span>, <span class="sc">-</span><span class="fl">0.05</span>),</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(sigma[<span class="dv">0</span>]), <span class="at">ylab =</span> <span class="fu">expression</span>(xi[<span class="dv">0</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="comparing-nested-models" class="section level3">
<h3>Comparing nested models</h3>
<p><code>alogLik</code> also has an <code>anova</code> method, which can
be used to perform (adjusted) loglikelihood ratio tests of nested
models. To illustrate this we fit, and adjust, a smaller model, in which
Oxford and Worthing have a common GEV shape parameter, and then compare
this model to the larger one.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>small <span class="ot">&lt;-</span> <span class="fu">gev_refit</span>(ow<span class="sc">$</span>temp, ow, <span class="at">mul =</span> <span class="dv">4</span>, <span class="at">sigl =</span> <span class="dv">4</span>, <span class="at">show =</span> <span class="cn">FALSE</span>, </span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;BFGS&quot;</span>)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>adj_small <span class="ot">&lt;-</span> <span class="fu">alogLik</span>(small, <span class="at">cluster =</span> ow<span class="sc">$</span>year, <span class="at">cadjust =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="fu">summary</span>(adj_small)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt;              MLE     SE adj. SE</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; loc      81.1200 0.3260 0.40640</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; locloc    2.4540 0.3047 0.20370</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; scale     3.7230 0.2232 0.24020</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; scaleloc  0.3537 0.2096 0.16840</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; shape    -0.1845 0.0488 0.04028</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="fu">anova</span>(adj_large, adj_small)</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt; Analysis of (Adjusted) Deviance Table</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt;           Model.Df Df  ALRTS Pr(&gt;ALRTS)  </span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; adj_large        6                       </span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt; adj_small        5  1 6.3572    0.01169 *</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a><span class="fu">anova</span>(adj_large, adj_small, <span class="at">type =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co">#&gt; Analysis of (Adjusted) Deviance Table</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a><span class="co">#&gt;           Model.Df Df  ALRTS Pr(&gt;ALRTS)  </span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a><span class="co">#&gt; adj_large        6                       </span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a><span class="co">#&gt; adj_small        5  1 3.1876     0.0742 .</span></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>We see that the adjustment of the loglikelihood for clustering makes
enough of a difference to matter: if we perform a test at the 5%
significance level then we choose the larger model when we adjust but
the smaller model if we do not.</p>
</div>
</div>
<div id="texmex" class="section level2">
<h2>texmex</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">library</span>(texmex, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co"># Note: phi = log(scale)</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>evm_fit <span class="ot">&lt;-</span> <span class="fu">evm</span>(temp, ow, gev, <span class="at">mu =</span> <span class="sc">~</span> loc, <span class="at">phi =</span> <span class="sc">~</span> loc, <span class="at">xi =</span> <span class="sc">~</span>loc)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>adj_evm_fit <span class="ot">&lt;-</span> <span class="fu">alogLik</span>(evm_fit, <span class="at">cluster =</span> ow<span class="sc">$</span>year)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="fu">summary</span>(adj_evm_fit)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt;                       MLE      SE adj. SE</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; mu: (Intercept)  81.17000 0.32820 0.40620</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt; mu: loc           2.66800 0.32820 0.21420</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; phi: (Intercept)  1.30600 0.06091 0.06531</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; phi: loc          0.14330 0.06091 0.05106</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt; xi: (Intercept)  -0.19900 0.04937 0.03968</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; xi: loc          -0.08821 0.04937 0.03647</span></span></code></pre></div>
</div>
<div id="evd" class="section level2">
<h2>evd</h2>
<p>The <code>fgev()</code> function in <em>evd</em> fits GEV regression
models, but it only allows covariate effects in the location
parameter.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">library</span>(evd, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>fgev_fit <span class="ot">&lt;-</span> <span class="fu">fgev</span>(ow<span class="sc">$</span>temp, <span class="at">nsloc =</span> ow[, <span class="st">&quot;loc&quot;</span>])</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>adj_fgev_fit <span class="ot">&lt;-</span> <span class="fu">alogLik</span>(fgev_fit, <span class="at">cluster =</span> ow<span class="sc">$</span>year)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="fu">summary</span>(adj_fgev_fit)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt;              MLE      SE adj. SE</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt; loc      81.1600 0.32980 0.40830</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; loctrend  2.5040 0.31080 0.19910</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt; scale     3.7900 0.22810 0.25230</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt; shape    -0.2097 0.04765 0.04063</span></span></code></pre></div>
</div>
<div id="extremes" class="section level2">
<h2>extRemes</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">library</span>(extRemes, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>fevd_fit <span class="ot">&lt;-</span> <span class="fu">fevd</span>(temp, ow, <span class="at">location.fun =</span> <span class="sc">~</span> ow<span class="sc">$</span>loc, <span class="at">scale.fun =</span> <span class="sc">~</span> ow<span class="sc">$</span>loc,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>                 <span class="at">shape.fun =</span> <span class="sc">~</span> ow<span class="sc">$</span>loc)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>adj_fevd_fit <span class="ot">&lt;-</span> <span class="fu">alogLik</span>(fevd_fit, <span class="at">cluster =</span> ow<span class="sc">$</span>year)</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="fu">summary</span>(adj_fevd_fit)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt;             MLE      SE adj. SE</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; mu0    81.17000 0.32820 0.40620</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; mu1     2.66800 0.32820 0.21420</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; sigma0  3.72900 0.22930 0.24410</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; sigma1  0.53090 0.22930 0.19230</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt; xi0    -0.19890 0.04938 0.03969</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; xi1    -0.08828 0.04938 0.03648</span></span></code></pre></div>
</div>
<div id="eva" class="section level2">
<h2>eva</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">library</span>(eva, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>gevr_fit <span class="ot">&lt;-</span> <span class="fu">gevrFit</span>(ow<span class="sc">$</span>temp, <span class="at">information =</span> <span class="st">&quot;observed&quot;</span>,</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>                    <span class="at">locvars =</span> ow, <span class="at">locform =</span> <span class="sc">~</span> ow<span class="sc">$</span>loc, </span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>                    <span class="at">scalevars =</span> ow, <span class="at">scaleform =</span> <span class="sc">~</span> ow<span class="sc">$</span>loc,</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>                    <span class="at">shapevars =</span> ow, <span class="at">shapeform =</span> <span class="sc">~</span> ow<span class="sc">$</span>loc)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>adj_gevr_fit <span class="ot">&lt;-</span> <span class="fu">alogLik</span>(gevr_fit, <span class="at">cluster =</span> ow<span class="sc">$</span>year)</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="fu">summary</span>(adj_gevr_fit)</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt;                          MLE      SE adj. SE</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; Location (Intercept) 81.1700 0.32810 0.40620</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt; Location ow$loc       2.6680 0.32810 0.21420</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; Scale (Intercept)     3.7290 0.22920 0.24400</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; Scale ow$loc          0.5307 0.22920 0.19230</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt; Shape (Intercept)    -0.1989 0.04936 0.03968</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt; Shape ow$loc         -0.0882 0.04936 0.03647</span></span></code></pre></div>
</div>
<div id="evir" class="section level2">
<h2>evir</h2>
<p>The <code>gev()</code> function in <em>evir</em> only fits stationary
GEV models.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">library</span>(evir, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>gev_fit <span class="ot">&lt;-</span> <span class="fu">gev</span>(ow<span class="sc">$</span>temp)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>adj_gev_fit <span class="ot">&lt;-</span> <span class="fu">alogLik</span>(gev_fit)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="fu">summary</span>(adj_gev_fit)</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt;           MLE      SE adj. SE</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; xi    -0.1801 0.06051  0.0509</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; sigma  4.3980 0.28180  0.2558</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; mu    80.7800 0.39240  0.4128</span></span></code></pre></div>
</div>
<div id="fextremes" class="section level2">
<h2>fExtremes</h2>
<p>The <code>gevFit()</code> function in <em>fExtremes</em> only fits
stationary GEV models.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">library</span>(fExtremes, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>gevFit_fit <span class="ot">&lt;-</span> <span class="fu">gevFit</span>(ow<span class="sc">$</span>temp)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>adj_gevFit_fit <span class="ot">&lt;-</span> <span class="fu">alogLik</span>(gevFit_fit)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="fu">summary</span>(adj_gevFit_fit)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co">#&gt;          MLE      SE adj. SE</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co">#&gt; xi   -0.1802 0.06047 0.05087</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co">#&gt; mu   80.7900 0.39240 0.41290</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co">#&gt; beta  4.3980 0.28170 0.25570</span></span></code></pre></div>
</div>
<div id="mev" class="section level2">
<h2>mev</h2>
<p>The <code>fit.gev()</code> function in <em>mev</em> only fits
stationary GEV models.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">library</span>(mev, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>gfit <span class="ot">&lt;-</span> <span class="fu">fit.gev</span>(ow<span class="sc">$</span>temp)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>adj_gfit <span class="ot">&lt;-</span> <span class="fu">alogLik</span>(gfit)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="fu">summary</span>(adj_gfit)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt;           MLE     SE adj. SE</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; loc   80.7800 0.3924 0.41290</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt; scale  4.3980 0.2818 0.25580</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; shape -0.1801 0.0605 0.05089</span></span></code></pre></div>
</div>
<div id="pot" class="section level2">
<h2>POT</h2>
<p>Among other things, the <code>fitgpd()</code> function in the
<em>POT</em> package can fit a GP distribution to threshold excesses
using maximum likelihood estimation. We illustrate <code>alogLik</code>
using an example from the <code>fitgpd</code> documentation. There is no
cluster dependence here. However, there may be interest in using a
sandwich estimator of covariance if we are concerned about model
misspecification. In this case, where we simulate from the correct
model, we expect the adjustment to make little difference, and so it
proves.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">library</span>(POT, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">24082019</span>)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> POT<span class="sc">::</span><span class="fu">rgpd</span>(<span class="dv">200</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="fl">0.25</span>)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">fitgpd</span>(x, <span class="dv">1</span>, <span class="st">&quot;mle&quot;</span>)</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>adj_fit <span class="ot">&lt;-</span> <span class="fu">alogLik</span>(fit)</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="fu">summary</span>(adj_fit)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt;          MLE      SE adj. SE</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; scale 1.8670 0.20930 0.19260</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; shape 0.2573 0.08887 0.07121</span></span></code></pre></div>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({  "HTML-CSS": { minScaleAdjust: 125, availableFonts: [] }  });
</script>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-eva" class="csl-entry">
Bader, B., and J. Yan. 2020. <em>Eva: Extreme Value Analysis with
Goodness-of-Fit Testing</em>. <a href="https://CRAN.R-project.org/package=eva">https://CRAN.R-project.org/package=eva</a>.
</div>
<div id="ref-mev" class="csl-entry">
Belzile, L., J. L. Wadsworth, P. J. Northrop, S. D. Grimshaw, and R.
Huser. 2019. <em><span class="nocase">m</span>ev: Multivariate Extreme
Value Distributions</em>. <a href="https://github.com/lbelzile/mev/">https://github.com/lbelzile/mev/</a>.
</div>
<div id="ref-CB2007" class="csl-entry">
Chandler, R. E., and S. Bate. 2007. <span>“Inference for Clustered Data
Using the Independence Loglikelihood.”</span> <em>Biometrika</em> 94
(1): 167–183. doi:<a href="https://doi.org/10.1093/biomet/asm015">10.1093/biomet/asm015</a>.
</div>
<div id="ref-extRemes" class="csl-entry">
Gilleland, E., and R. W. Katz. 2016. <span>“<span class="nocase">extRemes</span> 2.0: An Extreme Value Analysis Package in
<span>R</span>.”</span> <em>Journal of Statistical Software</em> 72 (8):
1–39. doi:<a href="https://doi.org/10.18637/jss.v072.i08">10.18637/jss.v072.i08</a>.
</div>
<div id="ref-ismev" class="csl-entry">
Heffernan, J. E., and A. G. Stephenson. 2018. <em><span class="nocase">i</span>smev: An Introduction to Statistical Modeling of
Extreme Values</em>. <a href="https://CRAN.R-project.org/package=ismev">https://CRAN.R-project.org/package=ismev</a>.
</div>
<div id="ref-evir" class="csl-entry">
Pfaff, B., and A. McNeil. 2018. <em><span class="nocase">e</span>vir:
Extreme Values in r</em>. <a href="https://CRAN.R-project.org/package=evir">https://CRAN.R-project.org/package=evir</a>.
</div>
<div id="ref-POT" class="csl-entry">
Ribatet, M., and C. Dutang. 2016. <em>POT: Generalized Pareto
Distribution and Peaks over Threshold</em>. <a href="https://CRAN.R-project.org/package=POT">https://CRAN.R-project.org/package=POT</a>.
</div>
<div id="ref-texmex" class="csl-entry">
Southworth, H., J. E. Heffernan, and P. D. Metcalfe. 2017. <em><span class="nocase">t</span>exmex: Statistical Modelling of Extreme
Values</em>. <a href="https://CRAN.R-project.org/package=texmex">https://CRAN.R-project.org/package=texmex</a>.
</div>
<div id="ref-evd" class="csl-entry">
Stephenson, A. G. 2002. <span>“<span class="nocase">e</span>vd: Extreme
Value Distributions.”</span> <em>R News</em> 2 (2): 0. <a href="https://CRAN.R-project.org/doc/Rnews/">https://CRAN.R-project.org/doc/Rnews/</a>.
</div>
<div id="ref-fExtremes" class="csl-entry">
Wuertz, D., T. Setz, and Y. Yohan Chalabi. 2017. <em><span class="nocase">fExtremes</span>: Rmetrics - Modelling Extreme Events in
Finance</em>. <a href="https://CRAN.R-project.org/package=fExtremes">https://CRAN.R-project.org/package=fExtremes</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
